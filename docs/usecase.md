1. Actor Definitions

Actor	설명
온라인 셀러	20~30대 남성 셀러. 상품별 마진 계산 및 월수입 집계를 수행하는 주체
시스템	웹 애플리케이션. 입력 검증, 계산, 데이터 저장·조회 등을 담당



⸻

2. Use Case Scenarios
	1.	UC01: 로그인/회원가입
	2.	UC02: 상품별 마진 계산
	3.	UC03: 판매처별 월수입 계산
	4.	UC04: 수익 이력 비교
	5.	UC05: 프로필 설정 및 관리

⸻

3. Main Steps

각 Use Case의 핵심 흐름 요약
	•	사용자 → 인증 → 대시보드 진입
	•	사용자 → 마진 입력 → 계산 결과 확인 → 저장
	•	사용자 → 수량 입력 → 월수입 집계 → 시각화
	•	사용자 → 이력 기간 설정 → 과거 대비 차트 조회
	•	사용자 → 프로필 수정 → 변경 사항 저장

⸻

4. Exception Handling
	•	입력 오류: 음수·문자 입력 시 인라인 에러 메시지 표시
	•	인증 오류: 세션 만료 시 로그인 페이지로 리디렉션
	•	서버 오류: “일시적인 오류입니다. 다시 시도해주세요.” 알림

⸻

5. Comprehensive Actor Definitions

Actor	목표	권한	특이사항
온라인 셀러	상품 마진 파악 및 월수입 집계로 수익 최적화	계산·저장·조회 뿐 아니라 과거 내역 조회	다중 플랫폼 이용 환경 고려
시스템	정확한 계산 로직 제공, 데이터 보관, 사용자 경험 유지	모든 기능 CRUD, 인증 체크	Supabase 인증·DB 사용



⸻

6. Detailed Use Case Scenarios

UC ID	이름	설명
UC01	로그인/회원가입	이메일·비밀번호 또는 OAuth로 인증하고, 신규는 회원가입까지 완료
UC02	상품별 마진 계산	매입가·판매가·배송비·수수료 입력 후 정산금·마진액·마진율 계산
UC03	판매처별 월수입 계산	플랫폼별 상품명·판매수량 입력 후 플랫폼별·전체 월수입 합계 산출
UC04	수익 이력 비교	기간 선택 후 과거 대비 수익 증감 차트를 제공
UC05	프로필 설정 및 관리	사용자 정보(이메일, 이름) 및 비밀번호 변경 기능



⸻

7. Main Steps and Flow of Events

UC01: 로그인/회원가입
	1.	사용자 → 로그인 페이지 접근
	2.	이메일·비밀번호 입력 → “로그인” 클릭
	3.	시스템
	1.	입력 검증
	2.	Supabase Auth 호출
	3.	세션 발급
	4.	사용자 → 대시보드(/dashboard) 진입

UC02: 상품별 마진 계산
	1.	사용자 → 마진 계산기 페이지(/calculator/margin) 진입
	2.	매입가·판매가·배송비·수수료 입력
	3.	시스템 → 입력 검증 → 마진 계산
	4.	시스템 → 결과(정산금, 마진율) 화면에 표시
	5.	사용자 → “저장” 클릭
	6.	시스템 → 결과 DB에 저장 → 성공 토스트

UC03: 판매처별 월수입 계산
	1.	사용자 → 월수입 계산기 페이지(/calculator/income) 진입
	2.	플랫폼 선택 → 상품명·판매수량 입력
	3.	시스템 → 입력 검증 → 월수입 합계 산출
	4.	시스템 → 플랫폼별·전체 수입 차트로 시각화
	5.	사용자 → “저장” 클릭 → DB 저장

⸻

8. Alternative Flows and Edge Cases

UC02 대체 흐름
	•	A1: 입력값 누락
	•	배송비 미입력 → “배송비를 입력해주세요.” 인라인 에러
	•	A2: 서버 응답 지연
	•	5초 이상 대기 → 로딩 상태 유지 후 “서버 응답이 없습니다.” 토스트

UC03 엣지 케이스
	•	E1: 동일 상품 여러 행 입력
	•	시스템: 합계 로직 처리, 중복 상품명 경고 → “동일 상품명이 중복되었습니다.”
	•	E2: 판매수량 0 입력
	•	“판매수량은 1 이상이어야 합니다.” 인라인 에러

⸻

9. Preconditions and Postconditions

UC ID	선행 조건 (Preconditions)	후행 조건 (Postconditions)
UC01	인터넷 연결, 인증 정보 없음 또는 만료	유효 세션 발급, 사용자 정보 로드
UC02	로그인 완료, 계산기 페이지 접근 권한	계산 결과 DB 저장, 대시보드 최근 내역에 표시
UC03	로그인 완료, 플랫폼 목록 로드 완료	월수입 기록 DB 저장, 차트 비교 대상에 포함
UC04	로그인 완료, 최소 두 개월 이상의 이력 데이터 존재	비교 차트 렌더링, 필터 적용
UC05	로그인 완료	프로필 정보 갱신, 보안 검증 후 변경 사항 적용



⸻

10. Business Rules and Constraints
	1.	입력값 검증
	•	매입가·판매가·배송비: 0 < 값 ≤ 1,000,000,000
	•	수수료: 0% ≤ 값 ≤ 100%
	•	판매수량: 정수, 1 ≤ 값 ≤ 1,000,000
	2.	인증 필수: 모든 주요 기능은 로그인 후에만 접근 가능
	3.	저장 제한: 하루 최대 100건 입력·저장
	4.	데이터 보존: 거래 데이터는 5년 보관

⸻

11. Exception Handling Procedures

상황	처리 절차
인증 실패	401 에러 → 로그인 페이지로 리디렉션 → “다시 로그인해주세요.” 메시지 출력
입력 검증 실패	인라인 에러 표시 → 잘못된 필드 포커스 이동
DB 저장 오류	트랜잭션 롤백 → “저장에 실패했습니다. 다시 시도해주세요.” 알림 → 로그 기록
네트워크 장애	재시도 버튼 제시 → 실패 시 “네트워크 상태를 확인해주세요.” 토스트
서버 오류 (5xx)	“서버 오류가 발생했습니다. 관리자에게 문의하세요.” 화면 중앙 모달



⸻

12. User Interface Considerations
	•	반응형 디자인:
	•	모바일(≤768px): 단일 컬럼, 풀스크린 폼
	•	태블릿·데스크탑: 2~3 컬럼 레이아웃, 사이드바 숨김
	•	접근성:
	•	모든 입력 필드 <label> 연계, 키보드 내비게이션 지원
	•	ARIA-live 영역에 계산 결과 자동 알림
	•	피드백 요소:
	•	로딩 스피너, 성공·오류 토스트, 인라인 검증 메시지

⸻

13. Data Requirements and Data Flow
	1.	주요 데이터 모델
	•	User(id, email, name, password_hash)
	•	MarginRecord(id, user_id, cost, price, fee, shipping, result, created_at)
	•	IncomeRecord(id, user_id, platform, product, quantity, total_income, created_at)
	2.	데이터 흐름
	1.	사용자 입력 → 프론트엔드 검증 → API 호출
	2.	Supabase Function → 계산 로직 수행 → 결과 반환
	3.	결과 → 화면 렌더링 + DB 저장 → 대시보드·이력 비교에 반영

⸻

14. Security and Privacy Considerations
	•	인증: Supabase Auth (JWT) 이용, HTTPS 강제 적용
	•	데이터 암호화: 비밀번호는 bcrypt 해시, 중요한 개인정보는 암호화 필드
	•	권한 검증: API 레벨에서 user_id 매핑 확인
	•	CSRF/XSS 방어: Next.js 기본 보안 헤더, 입력값 이스케이프
	•	개인정보 처리: 이메일 외 민감 정보 미수집, 개인정보처리방침 고지

⸻